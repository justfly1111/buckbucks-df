project( PaperDesktop )

cmake_minimum_required( VERSION 3.8 )

set( PROJECT_VERSION 0.1.0 )
set( PROJECT_VERSION_MAJOR 0 )
set( PROJECT_VERSION_MINOR 1 )
set( PROJECT_VERSION_PATCH 0 )

set( PROJECT_VERSION_MAJOR_MINOR ${PROJECT_VERSION_MAJOR}.${PROJECT_VERSION_MINOR} )
add_compile_definitions(VERSION_TEXT="${PROJECT_VERSION}")

set( CMAKE_CXX_STANDARD 17 )
set( CMAKE_INCLUDE_CURRENT_DIR ON )
set( CMAKE_BUILD_TYPE Release )

if ( CMAKE_INSTALL_PREFIX_INITIALIZED_TO_DEFAULT )
    set( CMAKE_INSTALL_PREFIX "/usr" CACHE PATH "Location for installing the project" FORCE )
endif()

# Get libcprime and libcsys if they are not found
find_package( PkgConfig REQUIRED )
pkg_check_modules( CPRIME QUIET cprime-core )

if ( CPRIME_FOUND )
    message( "-- CPrime found: version ${CPRIME_VERSION}" )
    pkg_get_variable( CPRIME_INCDIR cprime-core includedir )
    include_directories( CPRIME_INCDIR )

else()
    message( SEND_ERROR "-- CPrime not found. Please install libcprime to proceed." )
endif()

pkg_check_modules( CSYS QUIET csys )
if ( CSYS_FOUND )
    message( "-- CSys found: version ${CSYS_VERSION}" )
    pkg_get_variable( CSYS_INCDIR csys includedir )
    include_directories( CSYS_INCDIR )

else()
    message( SEND_ERROR "-- CSys not found. Please install libcsys to proceed." )
endif()

include_directories(
    ${CMAKE_CURRENT_BINARY_DIR}/libpaperde/core/
    ${CMAKE_CURRENT_BINARY_DIR}/libpaperde/gui/
    ${CMAKE_CURRENT_BINARY_DIR}/libpaperde/wl/
    ${CMAKE_CURRENT_SOURCE_DIR}/libpaperde/core/
    ${CMAKE_CURRENT_SOURCE_DIR}/libpaperde/core/utils/
    ${CMAKE_CURRENT_SOURCE_DIR}/libpaperde/gui/
    ${CMAKE_CURRENT_SOURCE_DIR}/libpaperde/gui/settings/
    ${CMAKE_CURRENT_SOURCE_DIR}/libpaperde/gui/layouts/
    ${CMAKE_CURRENT_SOURCE_DIR}/libpaperde/wl/
)

link_directories( ${CMAKE_CURRENT_BINARY_DIR}/libpaperde/core/ )
link_directories( ${CMAKE_CURRENT_BINARY_DIR}/libpaperde/gui/ )
link_directories( ${CMAKE_CURRENT_BINARY_DIR}/libpaperde/wl/ )

# add_subdirectory( bluetooth )
# add_subdirectory( clipboard )
add_subdirectory( libpaperde )
# add_subdirectory( network )
# add_subdirectory( notifications )
add_subdirectory( papershell )
add_subdirectory( powerdaemon )
add_subdirectory( sessionmanager )
add_subdirectory( settings )
add_subdirectory( settingsdaemon )
# add_subdirectory( sound )

add_dependencies( papershell paperdegui paperdewl )
add_dependencies( papersessionmanager paperdecore )
